<h1>New Wiki</h1>

<%= render plain: params[:page].inspect %>

<%= form_for :page, url: pages_path, html: { id: 'page_form' } do |f| %>
  <div class="form_group">
    <%= f.label :title, class: "form_label" %><br>
    <%= f.text_field :title, class: "text_field" %>
  </div>
  <div class="form_group">
    <%= hidden_field(:page, :user_id, value: current_user.id) %>
    <%= hidden_field(:page, :approval_status_id, value: 1) %>
  </div>
	<div class="category_label">
    <%= f.label :category, "Category:" %>
		<%= collection_select :page, :category_id, Category.order(:id), :id, :name, prompt: true %>
	</div>
  <div class="form_group">
    <%= f.label :content, class: "form_label" %><br>
      <div class="form-group">
      <%= f.hidden_field :content, :id => "post-content", required: true %>
      <div id="editor-container" hidden="true"></div>
      <div id="editor"></div>
    </div>
  </div>
  <div class="form_group">
    <%= f.submit "Post" %>
  </div>
<% end %>

<head><link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet"></head>

<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<!-- Initialize Quill editor -->
<script>

  var options = {
		modules: {
			toolbar: [
				[{ header: [1, 2, 3, false] }],
				[{ 'font': [] }],
				['bold', 'italic', 'underline', 'strike'],
				[{ 'color': [] }, { 'background': [] }],
				[{ 'list': 'ordered'}, { 'list': 'bullet' }],
				[{ 'align': [] }],
				[{ 'indent': '-1'}, { 'indent': '+1' }], 
				['blockquote', 'code-block'],
				['image', 'video']
			]
		},
		placeholder: 'Enter wiki content here.',
		theme: 'snow'
	}
  var form = document.querySelector('#page_form');
  var quill = new Quill('#editor', options);

  form.onsubmit = function() {
  var postContentInput = document.querySelector('#post-content');
  postContentInput.value = quill.root.innerHTML;
};
</script>

