<h1>New Wiki</h1>

<%= render plain: params[:page].inspect %>

<%= form_for :page, url: pages_path, html: { id: 'page_form' } do |f| %>
  <p>
    <%= f.label :title %><br>
    <%= f.text_field :title %>
  </p>
  <div>
    <%= hidden_field(:page, :user_id, value: current_user.id) %>
    <%= hidden_field(:page, :approval_status_id, value: 1) %>
  </div>
	<div>
		<%= collection_select :page, :category_id, Category.order(:id), :id, :name, include_blank: true %>
	</div>
  <div>
    <%= f.label :content %><br>
      <div class="form-group">
      <%= f.hidden_field :content, :id => "post-content", required: true %>
      <div id="editor-container" hidden="true"></div>
      <div id="editor"></div>
    </div>
  </div>

  <div>
    <%= f.submit "Post" %>
  </div>
<% end %>

<head><link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet"></head>

<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<!-- Initialize Quill editor -->
<script>

	var options = {
		modules: {
			toolbar: [
				[{ header: [1, 2, 3, false] }],
				['bold', 'italic', 'underline'],
				['image', 'code']
			]
		},
		placeholder: 'Enter wiki content here.',
		theme: 'snow'
	}
  var form = document.querySelector('#page_form');
  var quill = new Quill('#editor', options);

  form.onsubmit = function() {
  var postContentInput = document.querySelector('#post-content');
  postContentInput.value = quill.root.innerHTML;
};
</script>

